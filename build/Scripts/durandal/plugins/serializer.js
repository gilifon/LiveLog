define(["durandal/system"],function(e){return{typeAttribute:"type",space:void 0,replacer:function(e,g){if(e){var n=e[0];if("_"===n||"$"===n)return void 0}return g},serialize:function(g,n){return n=void 0===n?{}:n,(e.isString(n)||e.isNumber(n))&&(n={space:n}),JSON.stringify(g,n.replacer||this.replacer,n.space||this.space)},getTypeId:function(e){return e?e[this.typeAttribute]:void 0},typeMap:{},registerType:function(){var g=arguments[0];if(1==arguments.length){var n=g[this.typeAttribute]||e.getModuleId(g);this.typeMap[n]=g}else this.typeMap[g]=arguments[1]},reviver:function(e,g,n,a){var o=n(g);if(o){var t=a(o);if(t)return t.fromJSON?t.fromJSON(g):new t(g)}return g},deserialize:function(e,g){var n=this;g=g||{};var a=g.getTypeId||function(e){return n.getTypeId(e)},o=g.getConstructor||function(e){return n.typeMap[e]},t=g.reviver||function(e,g){return n.reviver(e,g,a,o)};return JSON.parse(e,t)}}});